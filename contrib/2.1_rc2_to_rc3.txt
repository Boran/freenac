#----------------------
# Update from RC2 to RC3
#----------------------

ALTER TABLE port ADD COLUMN snmp_idx INT;
ALTER TABLE port ADD COLUMN last_vlan INT;    
ALTER TABLE port ADD COLUMN last_activity DATETIME;
ALTER TABLE port ADD COLUMN auth_profile INT;    
ALTER TABLE switch ADD COLUMN scan BOOL;
ALTER TABLE systems ADD COLUMN expiry DATETIME;
ALTER TABLE vstatus ADD COLUMN color VARCHAR(6);
ALTER TABLE vlan ADD COLUMN color VARCHAR(6);
ALTER TABLE guirights ADD COLUMN ad_group VARCHAR(255) NOT NULL;
ALTER TABLE users ADD COLUMN GuiVlanRights VARCHAR(255);


CREATE TABLE `auth_profile` (
  `id` int(10) unsigned NOT NULL default '0',
  `method` varchar(16) NOT NULL default '',
  `config` text
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `EpoComputerProperties` (
  `LastUpdate` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
  `ParentID` int(11) NOT NULL,
  `ComputerName` varchar(255) default NULL,
  `DomainName` varchar(100) default NULL,
  `IPAddress` varchar(100) default NULL,
  `OSType` varchar(100) default NULL,
  `OSVersion` varchar(100) default NULL,
  `OSServicePackVer` varchar(100) default NULL,
  `OSBuildNum` smallint(6) default NULL,
  `NetAddress` varchar(100) default NULL,
  `UserName` varchar(128) default NULL,
  `IPHostName` varchar(255) default NULL,
  `TheTimestamp` binary(8) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `stat_systems` (
   `date` DATE NOT NULL default '0000-00-00',
   `vstatus` INT(10) UNSIGNED,
   `count` INT(11),
   PRIMARY KEY (`date`, `vstatus`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

CREATE TABLE `stat_ports` (
   `date` DATE NOT NULL default '0000-00-00',
   `auth_profile` INT,
   `count` INT(11),
   PRIMARY KEY (`date`, `auth_profile`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `nac_wsusneededpatches` (
 `TargetID` int(11) NOT NULL,
 `Title` varchar(200) NOT NULL,
 `Timestamp` datetime default NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `nac_wsuscomputertarget` (
 `TargetID` int(11) NOT NULL,
 `IPAddress` varchar(40) character set utf8 default NULL,
 `FullDomainName` varchar(255) character set utf8 default NULL,
 `OSMajorVersion` int(11) default NULL,
 `OSMinorVersion` int(11) default NULL,
 `OSBuildNumber` int(11) default NULL,
 `OSServicePackMajorNumber` int(11) default NULL,
 `OSServicePackMinorNumber` int(11) default NULL,
 `OSLocale` varchar(10) character set utf8 default NULL,
 `ComputerMake` varchar(64) character set utf8 default NULL,
 `ComputerModel` varchar(64) character set utf8 default NULL,
 `BiosVersion` varchar(64) character set utf8 default NULL,
 `BiosName` varchar(64) character set utf8 default NULL,
 `BiosReleaseDate` datetime default NULL,
 `ProcessorArchitecture` varchar(50) character set utf8 default NULL,
 `Timestamp` datetime default NULL,
 PRIMARY KEY  (`TargetID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `nac_wsusinstalledpatches` (
 `TargetID` int(11) NOT NULL,
 `Title` varchar(200) NOT NULL,
 `Timestamp` datetime default NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `nac_wsusosmap` (
 `OSid` tinyint(4) NOT NULL,
 `OSMajorVersion` smallint(6) NOT NULL,
 `OSMinorVersion` smallint(6) NOT NULL,
 `OSBuildNumber` smallint(6) NOT NULL,
 `OSServicePackMajorNumber` smallint(6) NOT NULL,
 `OSServicePackMinorNumber` smallint(6) NOT NULL,
 `ProcessorArchitecture` varchar(50) character set utf8 NOT NULL,
 `OSShortName` varchar(16) default NULL,
 `OSLongName` mediumtext,
 PRIMARY KEY  (`OSid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


CREATE TABLE `nac_wsusprocessor` (
  `Pid` tinyint(4) NOT NULL,
  `ProcessorArchitecture` varchar(50) character set utf8 default NULL,
  PRIMARY KEY (`Pid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


INSERT INTO `nac_wsusprocessor` VALUES
(1,'x86'),(2,'x86-64'),(3,'AMD64');

