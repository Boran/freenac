________ CHANGES Version 2.2 ___________

To compare changes in your installation with the FreeNAC repository:
  svn status -u
This reports, but does not commit any changes.


History of this Branch 2.2
===========================

---- Changes V2.2 RC3 (SVN tag 876)

 * Most documentation is now gone. You can browse our documentation
   online in http://www.freenac.net and comment and contribute to 
   enhance it. 
 * Added some functions in funcs.inc
 * Better Web GUI integration
	Delete button
 * Modifications to port_scan
 	Added --verbose switch to activate debug1
	Modified to support new and old variables
	Removed config file
 * Renamed config options in Windows GUI
 * Deleted unnecessary information from config.inc.template
 * Modifications to vmps_lastseen
	When unknown detected via SMS, update the os4 field, not just os2 
 * DB structure and fields for the config table have been updated	

---- Changes from V2.2 RC1 to V2.2 RC2 (SVN tag 776)
 * Web 1 and Web 2 were put together into a single interface /web
   with AD auth made optional
 * Fixed several bugs in vmpsd_external and added new features
	Set an expired device to killed
	Hostname when killing a system
	Ignoring null dates
	VLAN by switch location
	Hub detection
	Handling of VMs
	Check for unknown status
 * Fixed several bugs in vmps_lastseen and added new features
	GWP detection
	Update port regardless of check_for_expired
	Add switchname when a new switch is detected
	Added hostname when warning about expired
	Add port and sswitch comments if no patchcable info is found
 * Modified version of restart_port using SNMP
 * New functions introduced in funcs.inc. Some of them are not used at the moment,
   but they'll be in the near future
	is_mac_on_port
	ping_mac2
	is_field_active
 * Added more monitoring scripts
 * Added more documentation
 * Fixes in the Windows GUI
 * Importing of the variables contained in the config.inc file into the config table
 * Creation of a Settings class that holds global configuration variables.
   This Settings class marks our first steps towards the development of a 
   OO policy interface.
   All scripts have been modified accordingly


---- Changes from V2.1 RC3 to V2.2 RC1 (SVN tag 550)

Key changes:
 o Database redesign: improved keys, field names and table names will allow the DB
   to better grow with time and ensure better data consistency.
   There were for example, locations as text fields in several tables. There are now 
   lookups into a location table which in turn looks into a building table.
   Many new empty base tables for the enterprise edition were added.
   -- See the drawing db_schema_v2.2.jpg in the doc directory.
   
 o The server scripts, Web and Windows GUI have been adapted to suit the new schema.
 o The new db name is by default 'opennac' (and can be changed); it was 'inventory' before.    
 o Many cosmetic changes to the Windows Gui
 o End-devices: add an expiry date, set in the Windows GUI, checked in vmpsd_external
 o Ports: record the last vlan used, and when.
 o The end-device status has been extended from enabled/disabled to:
   unknown, active, unmanaged, killed.
 o Docs updated

---- Changes from V2.1 RC2 to V2.1 RC3

   Added some features to some scripts
   Added new scripts
   Modified configuration scripts to add new vars for the new scripts
   Fixed a php include problem for all the scripts
   Changes to the db schema
   Enhancements made to the GUIs
   Added sample configuration files for FreeRadius, Samba, Kerberos
   More documentation 

---- Changes from V2.1 RC1 to V2.1 RC2

   Added 802.1x support with MAC validation (through the rad2vmps module)
   Added ad_user_sync module
   Some documentation reviewed and added 802.1x doc
   Added configuration files for freeradius, samba, kerberos

---- Changes since From snapshot 20.05.2006 (we call it Version 2.0) to V2.1:
---- Tarball freenac_2.1.rc1.tar.gz created. Comprises revision 155 from repository ho/14.9.06


  contrib/init.d: Fix startup order, add 5 sec delay in vmps to ensure mysql OK.

  Move rdiff.exclude rdiff.run to contrib, enable from cron.

  funcs.inc: new insert_user()
    Add mysql_real_escape_string to reporterr

  router_mac_ip, config.inc: 
    Add new router_mac_ip_update_from_dns feature.
 
  monitor_mysql_slave: 
    New script to be run on MySQL slaves. 
    See http://www.opennac.net/phpBB2/viewtopic.php?p=12#12

  vmps_lastseen: 
    When new ports found set the 'office' field to the patch location 
    (if available) or then switch location.
    Better debugging with dryrun. Check feof. If a 00000 mac is
    received reset log_msg and other vars.
    Move direx_tXX & check_infnet_mac to swisscom.only subdir
    replace direx_tXX with direx (direx_sync_user() function)
    Username in Uppercase: set keine->KEINE

  vmps_lastseen & sms_infnet_mac: [status: INO: OK, BW: OK ACA:OK ]
    Rather than using a HTTP request to PCexplorer, now do an MS-SQL request
    to the SMS DB. This also requires installing /opt/freetds and a new PHP
    that is linked against the TDS libraries.
    Add Operating system in SMS DB to new os3 field in systems table,
    when infnet systems found. 

  vmps_lastseen: 
    Move swisscom includes/SMS variables to config.inc

  Move to swisscom.only subdir: 
    check_infnet_mac: Better debugging use funcs.inc, remove debug1()
    direx_tXX: Use simplexml  [depreciated]
    direx: Use simplexml  [for direx_sync_user(), new]
    report_old_users: update cron.
    vmps_users: , handle umlauts for all fields, update cron.
    vmps_users_special: update cron. 
      handle Umlauts & Accents correctly
    Also move relevant /opt/vmps/RCS files to /opt/vmps/swisscom.only/RCS

  syslog: logrotate_syslog_conf
  monitor_allows_count.sh
    Report to syslog, not email (to reduce daily flood)

  purge_unknowns: 
   search for *unknown* and not just 'unknown' systems

  DB: 
  There needs to be a 'keine' user, that all unknown machines are assigned to:
    insert into users set AssocNtAccount='KEINE';
    update systems set description='KEINE' where description='';

  DB: 
    grant SELECT,UPDATE        ON inventory.vlan    to inventwrite@'%' ;
    ALTER TABLE `inventory`.`sys_os` ADD PRIMARY KEY(`id`);
    ALTER TABLE `inventory`.`sys_class` ADD PRIMARY KEY(`id`);
    ALTER TABLE `inventory`.`systems` DROP PRIMARY KEY;
    ALTER TABLE `inventory`.`systems` ADD PRIMARY KEY(`mac`);
    alter table systems add column os3 varchar(30);
    alter table systems add column os4 varchar(30);

    Username in Uppercase:
    update inventory.systems set description=UPPER(description);
    update inventory.users set AssocNtAccount=UPPER(AssocNtAccount);

  DB: 
    Create additioanl classification via lookup table sys_class2: and populate manually.
      create table sys_class2 SELECT * from sys_class;
      grant UPDATE,INSERT ON inventory.sys_class2   to inventwrite@'%' 
    +----+----------------+
    | id | value          |
    +----+----------------+
    |  0 | unknown        |
    |  1 | Typ I      |
    |  2 |  Typ II     |
    |  3 |  Typ III    |
    | 10 | NON-GWP Typ I  |
    | 20 | NON-GWP Typ II |
    +----+----------------+
    Add new field to systems table:
      alter table systems add column class2 int(11) default 0;
      alter table systems drop column AuthLast;
      alter table systems drop column AuthPort;
      alter table systems drop column AuthSw;
      alter table systems drop column AuthVlan;
      alter table systems add column scannow tinyint(4) default 0;

  DB: 
    create table vstatus select * from status;
    No longer needed old 'status' table: but upgrade Delphi GUI first.
      drop table status;


  UNIX: 
    ln -s /opt/vmps /opt/nac
    ln -s /opt/nac21 /opt/nac

  Subversion: 
    Move all scripts to bin/etc/contrib subdirectories, under SVN
    control. Move svn doc directory to trunk.

  Delphi vmps.exe GUI v1.2.0.97
    Edit tab: add nmap, epo, SMS fields. Organised bottom part into new tab.
    Edit tab: add new classification 
    Enable Admin->Encrypt user before connecting
    Fix Overview->By User list, so it includes Surname/Forename.
    Overview: drop green colour for Secure
    Edit tab: add Inventory details, Inventory query button
    Rewrite 'Overview' to use an advanced Query, making it faster.
    vmps.xml: add parameters for link to static inventory:
        <settings StaticInv="1" />
        <mssql-inv server="SERVER\INSTANCE" auth="PASSWORD" database="inventory" />  	


----- /Baseline: Snapshot 20.05.2006
